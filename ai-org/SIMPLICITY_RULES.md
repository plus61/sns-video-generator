# 🎯 シンプリシティ・ルール - 複雑化防止ガイドライン

## 基本原則：KISS (Keep It Simple, Stupid)

### 1. 🚫 やってはいけないこと

#### Docker地獄を避ける
- ❌ multi-stage Dockerfileの過度な使用
- ❌ 複雑なビルドパイプライン
- ✅ **代替案**: プラットフォームのネイティブ機能を使う（例：Railway Nixpacks）

#### 設定ファイルの乱立
- ❌ 同じ目的の設定ファイルを複数作成
- ❌ 環境ごとに別々の設定ファイル
- ✅ **代替案**: 環境変数で制御する単一設定

#### 過度な抽象化
- ❌ 3層以上のラッパー関数
- ❌ 将来のための過剰な準備
- ✅ **代替案**: YAGNI (You Ain't Gonna Need It)

### 2. ✅ 推奨パターン

#### 最小限の設定
```javascript
// 悪い例
const config = {
  development: { /* 20行の設定 */ },
  staging: { /* 20行の設定 */ },
  production: { /* 20行の設定 */ }
};

// 良い例
const config = {
  apiUrl: process.env.API_URL || 'default',
  debug: process.env.NODE_ENV !== 'production'
};
```

#### エラーメッセージの明確化
```javascript
// 悪い例
throw new Error('Error occurred');

// 良い例
throw new Error('Database connection failed: ECONNREFUSED 127.0.0.1:5432');
```

#### 依存関係の最小化
- 本当に必要なパッケージのみインストール
- 似た機能のパッケージは統一する
- ネイティブ機能で実現できることは外部パッケージを使わない

### 3. 🔍 問題解決アプローチ

#### ステップ1: 最もシンプルな解決策を試す
1. プラットフォームのデフォルト設定
2. 公式ドキュメントの推奨方法
3. 実績のある標準的なパターン

#### ステップ2: 段階的な複雑化
- シンプルな解決策が失敗した場合のみ
- 一度に一つの変更
- 各ステップで動作確認

#### ステップ3: ドキュメント化
- なぜその解決策を選んだか
- 試して失敗した方法
- 次回のための教訓

### 4. 📊 デプロイメント戦略

#### Railway Deployment の教訓
1. **Dockerより Nixpacks**
   - 理由: 自動検出、設定不要
   
2. **Standalone出力の活用**
   - 理由: 最小限の依存関係、高速起動

3. **環境変数の一元管理**
   - 理由: 設定の可視化、変更の容易さ

### 5. 🚨 複雑化の兆候

以下が見られたら立ち止まって再考：
- 設定ファイルが5個以上
- ビルド時間が5分以上
- READMEが100行以上
- エラー解決に1時間以上

### 6. 🎯 判断基準

新しい技術やツールを導入する前に：

1. **必要性**: 本当に必要か？既存の方法で解決できないか？
2. **簡潔性**: より簡単な代替案はないか？
3. **保守性**: 6ヶ月後の自分が理解できるか？
4. **標準性**: 業界標準やベストプラクティスに沿っているか？

### 7. 📝 チェックリスト

PR/実装前の確認事項：
- [ ] 設定は環境変数で管理されているか
- [ ] ドキュメントは10行以内で要点を説明できるか
- [ ] 依存関係は最小限か
- [ ] エラーメッセージは具体的か
- [ ] テストは実際の使用シナリオを反映しているか

### 8. 💡 格言集

- "Perfect is the enemy of good"
- "Make it work, make it right, make it fast" (この順番で)
- "The best code is no code"
- "Complexity is the enemy of execution"

---

## 実例：Railway Deployment

❌ **複雑化した例**:
- 5種類のDockerfile作成
- 複数の設定ファイル修正
- カスタムビルドスクリプト

✅ **シンプルな解決策**:
```toml
# next.config.mjs に1行追加
output: 'standalone'
```

この1行の変更で問題解決。これがシンプリシティの力。