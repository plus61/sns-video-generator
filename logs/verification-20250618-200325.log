æœ€æ–°ã‚³ãƒŸãƒƒãƒˆ: a89330b9d6766accd77c9e53bd49fbb97f5cff54 Fix: Remove --omit=optional flag from npm ci in Dockerfile
[1;33mâš ï¸  æœªã‚³ãƒŸãƒƒãƒˆã®å¤‰æ›´ãŒã‚ã‚Šã¾ã™[0m

[0;34m=== package-lock.jsonåŒæœŸãƒã‚§ãƒƒã‚¯ ===[0m
[0;32mâœ… package-lock.jsonã¯åŒæœŸã•ã‚Œã¦ã„ã¾ã™[0m

[0;34m=== ä¾å­˜é–¢ä¿‚ãƒã‚§ãƒƒã‚¯ ===[0m
[0;32mâœ… youtube-dl-execã¯æ­£ã—ãè¨˜éŒ²ã•ã‚Œã¦ã„ã¾ã™[0m

[0;34m=== Dockerfileè¨­å®šãƒã‚§ãƒƒã‚¯ ===[0m
[0;32mâœ… Dockerfileã‹ã‚‰--omit=optionalãƒ•ãƒ©ã‚°ãŒå‰Šé™¤ã•ã‚Œã¦ã„ã¾ã™[0m
[0;32mâœ… USE_MOCK_DOWNLOADERç’°å¢ƒå¤‰æ•°ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã™[0m

[0;34m=== ãƒ­ãƒ¼ã‚«ãƒ«ãƒ“ãƒ«ãƒ‰ãƒ†ã‚¹ãƒˆ ===[0m
ãƒ“ãƒ«ãƒ‰ã‚’å®Ÿè¡Œä¸­...
[0;31mâŒ ãƒ­ãƒ¼ã‚«ãƒ«ãƒ“ãƒ«ãƒ‰ãŒå¤±æ•—ã—ã¾ã—ãŸ[0m
ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°:
    at async /Users/yuichiroooosuger/sns-video-generator/sns-video-generator/node_modules/next/dist/build/webpack/loaders/postcss-loader/src/index.js:52:40
    at async Span.traceAsyncFn (/Users/yuichiroooosuger/sns-video-generator/sns-video-generator/node_modules/next/dist/trace/trace.js:157:20)
    at Object.<anonymous> (/Users/yuichiroooosuger/sns-video-generator/sns-video-generator/node_modules/next/dist/build/webpack/loaders/css-loader/src/index.js??ruleSet[1].rules[13].oneOf[10].use[2]!/Users/yuichiroooosuger/sns-video-generator/sns-video-generator/node_modules/next/dist/build/webpack/loaders/postcss-loader/src/index.js??ruleSet[1].rules[13].oneOf[10].use[3]!/Users/yuichiroooosuger/sns-video-generator/sns-video-generator/src/app/globals.css:1:7)
    at /Users/yuichiroooosuger/sns-video-generator/sns-video-generator/node_modules/next/dist/compiled/webpack/bundle5.js:29:962742
    at Hook.eval [as call] (eval at create (/Users/yuichiroooosuger/sns-video-generator/sns-video-generator/node_modules/next/dist/compiled/webpack/bundle5.js:14:9002), <anonymous>:7:1)
    at Hook.CALL_DELEGATE [as _call] (/Users/yuichiroooosuger/sns-video-generator/sns-video-generator/node_modules/next/dist/compiled/webpack/bundle5.js:14:6272)
    at /Users/yuichiroooosuger/sns-video-generator/sns-video-generator/node_modules/next/dist/compiled/webpack/bundle5.js:29:131581
    at tryRunOrWebpackError (/Users/yuichiroooosuger/sns-video-generator/sns-video-generator/node_modules/next/dist/compiled/webpack/bundle5.js:29:316096)
    at __webpack_require_module__ (/Users/yuichiroooosuger/sns-video-generator/sns-video-generator/node_modules/next/dist/compiled/webpack/bundle5.js:29:131548)
    at __nested_webpack_require_161494__ (/Users/yuichiroooosuger/sns-video-generator/sns-video-generator/node_modules/next/dist/compiled/webpack/bundle5.js:29:130983)
    at /Users/yuichiroooosuger/sns-video-generator/sns-video-generator/node_modules/next/dist/compiled/webpack/bundle5.js:29:131840
    at symbolIterator (/Users/yuichiroooosuger/sns-video-generator/sns-video-generator/node_modules/next/dist/compiled/neo-async/async.js:1:14444)

Generated code for /Users/yuichiroooosuger/sns-video-generator/sns-video-generator/node_modules/next/dist/build/webpack/loaders/css-loader/src/index.js??ruleSet[1].rules[13].oneOf[10].use[2]!/Users/yuichiroooosuger/sns-video-generator/sns-video-generator/node_modules/next/dist/build/webpack/loaders/postcss-loader/src/index.js??ruleSet[1].rules[13].oneOf[10].use[3]!/Users/yuichiroooosuger/sns-video-generator/sns-video-generator/src/app/globals.css

Import trace for requested module:
./src/app/globals.css


> Build failed because of webpack errors

[0;34m=== ç’°å¢ƒå¤‰æ•°ãƒã‚§ãƒƒã‚¯ ===[0m
[1;33mâš ï¸  NEXT_PUBLIC_SUPABASE_URL ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“[0m
[1;33mâš ï¸  NEXT_PUBLIC_SUPABASE_ANON_KEY ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“[0m
[1;33mâš ï¸  SUPABASE_SERVICE_ROLE_KEY ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“[0m
[1;33mâš ï¸  OPENAI_API_KEY ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“[0m
[1;33mâš ï¸  NEXTAUTH_URL ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“[0m
[1;33mâš ï¸  NEXTAUTH_SECRET ãŒè¨­å®šã•ã‚Œã¦ã„ã¾ã›ã‚“[0m

[0;34m=== äº’æ›æ€§ãƒ¬ã‚¤ãƒ¤ãƒ¼ãƒã‚§ãƒƒã‚¯ ===[0m
[0;32mâœ… src/lib/compatibility-layer.ts ãŒå­˜åœ¨ã—ã¾ã™[0m
[0;32mâœ… src/lib/video-processor-vercel.ts ãŒå­˜åœ¨ã—ã¾ã™[0m
[0;32mâœ… src/lib/youtube-downloader.ts ãŒå­˜åœ¨ã—ã¾ã™[0m

[0;34m=== Dockerãƒ“ãƒ«ãƒ‰ãƒ†ã‚¹ãƒˆ ===[0m
Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ãƒ“ãƒ«ãƒ‰ä¸­...
[0;31mâŒ Dockerãƒ“ãƒ«ãƒ‰ãŒå¤±æ•—ã—ã¾ã—ãŸ[0m
ã‚¨ãƒ©ãƒ¼ãƒ­ã‚°:
0.616    Creating an optimized production build ...
0.869 
0.869 > Build error occurred
0.873 Error: Cannot find module 'lightningcss-linux-x64-musl'
0.873 Require stack:
0.873 - /app/next.config.js
0.873     at Object.webpack (next.config.js:34:48) {
0.873   code: 'MODULE_NOT_FOUND',
0.873   requireStack: [Array]
0.873 }
------
Dockerfile:41
--------------------
  39 |     ENV DISABLE_BULLMQ=false
  40 |     # Use Railway-specific config for build
  41 | >>> RUN if [ -f next.config.railway.js ]; then cp next.config.railway.js next.config.js; fi && npm run build
  42 |     
  43 |     # Production stage
--------------------
ERROR: failed to solve: process "/bin/sh -c if [ -f next.config.railway.js ]; then cp next.config.railway.js next.config.js; fi && npm run build" did not complete successfully: exit code: 1

[0;34m=== TypeScriptã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ãƒã‚§ãƒƒã‚¯ ===[0m
[1;33mâš ï¸  TypeScriptã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚¨ãƒ©ãƒ¼ãŒã‚ã‚Šã¾ã™[0m
__tests__/api/upload-youtube.test.ts(33,51): error TS2322: Type 'unknown' is not assignable to type 'Body | undefined'.
__tests__/api/upload-youtube.test.ts(321,19): error TS2540: Cannot assign to 'NODE_ENV' because it is a read-only property.
__tests__/api/upload-youtube.test.ts(326,19): error TS2540: Cannot assign to 'NODE_ENV' because it is a read-only property.
__tests__/api/upload-youtube.test.ts(355,19): error TS2540: Cannot assign to 'NODE_ENV' because it is a read-only property.
__tests__/auth/authentication.test.ts(319,19): error TS2540: Cannot assign to 'NODE_ENV' because it is a read-only property.
__tests__/auth/authentication.test.ts(324,19): error TS2540: Cannot assign to 'NODE_ENV' because it is a read-only property.
src/app/api/billing/webhook/route.ts(16,35): error TS2339: Property 'get' does not exist on type 'Promise<ReadonlyHeaders>'.
src/app/api/health/route.ts(58,32): error TS2353: Object literal may only specify known properties, and 'responseTime' does not exist in type '{ status: "up" | "down"; waiting: number; active: number; failed: number; completed: number; error?: string | undefined; }'.
src/app/api/health/route.ts(98,7): error TS2353: Object literal may only specify known properties, and 'responseTime' does not exist in type '{ status: "up" | "down"; waiting: number; active: number; failed: number; completed: number; error?: string | undefined; }'.
src/app/api/health/route.ts(113,7): error TS2353: Object literal may only specify known properties, and 'responseTime' does not exist in type '{ status: "up" | "down"; waiting: number; active: number; failed: number; completed: number; error?: string | undefined; }'.
src/app/api/queue/stats/route.ts(86,54): error TS7006: Parameter 'job' implicitly has an 'any' type.
src/app/api/queue/stats/route.ts(90,48): error TS7006: Parameter 'job' implicitly has an 'any' type.
src/app/api/queue/stats/route.ts(96,15): error TS7006: Parameter 'job' implicitly has an 'any' type.
src/app/api/queue/stats/route.ts(100,34): error TS7006: Parameter 'sum' implicitly has an 'any' type.
src/app/api/queue/stats/route.ts(100,39): error TS7006: Parameter 'job' implicitly has an 'any' type.
src/app/api/queue/stats/route.ts(116,25): error TS7006: Parameter 'job' implicitly has an 'any' type.
src/app/api/queue/stats/route.ts(126,39): error TS7006: Parameter 'job' implicitly has an 'any' type.
src/app/api/queue/stats/route.ts(134,41): error TS7006: Parameter 'job' implicitly has an 'any' type.
src/app/api/queue/stats/route.ts(145,37): error TS7006: Parameter 'job' implicitly has an 'any' type.
src/app/api/queue/stats/route.ts(166,9): error TS2322: Type 'unknown' is not assignable to type 'number'.

[0;34m=== æ¤œè¨¼çµæœã‚µãƒãƒªãƒ¼ ===[0m

æ¤œè¨¼å®Œäº†æ™‚åˆ»: #åˆå¾Œ
ã‚¨ãƒ©ãƒ¼æ•°: 2
[0;31mâš ï¸  2 å€‹ã®ã‚¨ãƒ©ãƒ¼ãŒæ¤œå‡ºã•ã‚Œã¾ã—ãŸ[0m

ä¸Šè¨˜ã®ã‚¨ãƒ©ãƒ¼ã‚’ä¿®æ­£ã—ã¦ã‹ã‚‰å†åº¦æ¤œè¨¼ã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„

è©³ç´°ãƒ­ã‚°: ./logs/verification-20250618-200325.log
